{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "FQDomainName": {
      "defaultValue": "practice.com",
      "type": "string"
    },
    "publicIPAddresses_globant_gateway_ip_domainNameLabel": {
      "defaultValue": "globantgatewaydomain",
      "type": "SecureString"
    },
    "applicationGateways_globant_gateway_name": {
      "defaultValue": "globant-gateway",
      "type": "String"
    },
    "publicIPAddresses_globant_gateway_ip_name": {
      "defaultValue": "globant-gateway-ip",
      "type": "String"
    },
    "sites_globant_app_name": {
      "defaultValue": "globant-webapp",
      "type": "String"
    },
    "serverfarms_globant_plan_name": {
      "defaultValue": "globant-webapp-plan",
      "type": "String"
    },
    "components_globant_app_name": {
      "defaultValue": "globant-webapp",
      "type": "String"
    },
    "virtualMachines_ad_server_name": {
      "defaultValue": "ad-server",
      "type": "String"
    },
    "virtualMachines_jum_server_name": {
      "defaultValue": "jum-server",
      "type": "String"
    },
    "virtualMachines_tool_server_name": {
      "defaultValue": "tool-server",
      "type": "String"
    },
    "servers_globant_database_server_name": {
      "defaultValue": "globant-database-server",
      "type": "String"
    },
    "networkSecurityGroups_ad_nsg_name": {
      "defaultValue": "ad-nsg",
      "type": "String"
    },
    "virtualNetworks_globant_vnet_name": {
      "defaultValue": "globant-vnet",
      "type": "String"
    },
    "networkSecurityGroups_jump_nsg_name": {
      "defaultValue": "jump-nsg",
      "type": "String"
    },
    "networkSecurityGroups_tool_nsg_name": {
      "defaultValue": "tool-nsg",
      "type": "String"
    },
    "publicIPAddresses_ad_server_ip_name": {
      "defaultValue": "ad-server-ip",
      "type": "String"
    },
    "storageAccounts_globantstorage_name": {
      "defaultValue": "globantstorage",
      "type": "String"
    },
    "publicIPAddresses_jum_server_ip_name": {
      "defaultValue": "jum-server-ip",
      "type": "String"
    },
    "publicIPAddresses_tool_server_ip_name": {
      "defaultValue": "tool-server-ip",
      "type": "String"
    },
    "networkInterfaces_ad_server_network_interface_name": {
      "defaultValue": "ad-server-network-interface",
      "type": "String"
    },
    "networkInterfaces_jum_server_network_interface_name": {
      "defaultValue": "jum-server-network-interface",
      "type": "String"
    },
    "networkInterfaces_tool_server_network_interface_name": {
      "defaultValue": "tool-server-network-interface",
      "type": "String"
    },
    "_artifactsLocation": {
      "type": "string",
      "metadata": {
        "description": "Auto-generated container in staging storage account to receive post-build staging folder upload"
      }
    },
    "_artifactsLocationSasToken": {
      "type": "securestring",
      "metadata": {
        "description": "Auto-generated token to access _artifactsLocation"
      }
    }
  },
  "variables": {
    "dscDCArchiveFolder": "DSC",
    "dscDCArchiveFileName": "dscDC.zip"},
  "resources": [
    {
      "type": "microsoft.insights/components",
      "apiVersion": "2015-05-01",
      "name": "[parameters('components_globant_app_name')]",
      "location": "eastus",
      "kind": "web",
      "properties": {
        "Application_Type": "web",
        "Request_Source": "IbizaWebAppExtensionCreate"
      }
    },
    {
      "type": "Microsoft.Network/applicationGateways",
      "apiVersion": "2018-12-01",
      "name": "[parameters('applicationGateways_globant_gateway_name')]",
      "location": "westus",
      "dependsOn": [
        "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_globant_vnet_name'), 'default-subnet')]",
        "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_globant_gateway_ip_name'))]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "0cea52d9-ea5f-4850-8b65-a6253dacf8c7",
        "sku": {
          "name": "WAF_Medium",
          "tier": "WAF",
          "capacity": 2
        },
        "gatewayIPConfigurations": [
          {
            "name": "appGatewayIpConfig",
            "etag": "W/\"2395ec85-c71e-47df-93fe-e3c46867f7c0\"",
            "properties": {
              "provisioningState": "Succeeded",
              "subnet": {
                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_globant_vnet_name'), 'default-subnet')]"
              }
            },
            "type": "Microsoft.Network/applicationGateways/gatewayIPConfigurations"
          }
        ],
        "sslCertificates": [],
        "authenticationCertificates": [],
        "frontendIPConfigurations": [
          {
            "name": "appGatewayFrontendIP",
            "etag": "W/\"2395ec85-c71e-47df-93fe-e3c46867f7c0\"",
            "type": "Microsoft.Network/applicationGateways/frontendIPConfigurations",
            "properties": {
              "provisioningState": "Succeeded",
              "privateIPAllocationMethod": "Dynamic",
              "publicIPAddress": {
                "id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_globant_gateway_ip_name'))]"
              }
            }
          }
        ],
        "frontendPorts": [
          {
            "name": "appGatewayFrontendPort",
            "etag": "W/\"2395ec85-c71e-47df-93fe-e3c46867f7c0\"",
            "properties": {
              "provisioningState": "Succeeded",
              "port": 80
            },
            "type": "Microsoft.Network/applicationGateways/frontendPorts"
          }
        ],
        "backendAddressPools": [
          {
            "name": "appGatewayBackendPool",
            "etag": "W/\"2395ec85-c71e-47df-93fe-e3c46867f7c0\"",
            "properties": {
              "provisioningState": "Succeeded",
              "backendAddresses": [
                {
                  "fqdn": "globant-webapp.azurewebsites.net"
                }
              ]
            },
            "type": "Microsoft.Network/applicationGateways/backendAddressPools"
          }
        ],
        "backendHttpSettingsCollection": [
          {
            "name": "appGatewayBackendHttpSettings",
            "etag": "W/\"2395ec85-c71e-47df-93fe-e3c46867f7c0\"",
            "properties": {
              "provisioningState": "Succeeded",
              "port": 80,
              "protocol": "Http",
              "cookieBasedAffinity": "Disabled",
              "pickHostNameFromBackendAddress": true,
              "requestTimeout": 30,
              "probe": {
                "id": "[concat(resourceId('Microsoft.Network/applicationGateways', parameters('applicationGateways_globant_gateway_name')), '/probes/appGatewayBackendHttpSettings67ee2a16-db6a-46ad-bc17-600861325012')]"
              }
            },
            "type": "Microsoft.Network/applicationGateways/backendHttpSettingsCollection"
          }
        ],
        "httpListeners": [
          {
            "name": "appGatewayHttpListener",
            "etag": "W/\"2395ec85-c71e-47df-93fe-e3c46867f7c0\"",
            "properties": {
              "provisioningState": "Succeeded",
              "frontendIPConfiguration": {
                "id": "[concat(resourceId('Microsoft.Network/applicationGateways', parameters('applicationGateways_globant_gateway_name')), '/frontendIPConfigurations/appGatewayFrontendIP')]"
              },
              "frontendPort": {
                "id": "[concat(resourceId('Microsoft.Network/applicationGateways', parameters('applicationGateways_globant_gateway_name')), '/frontendPorts/appGatewayFrontendPort')]"
              },
              "protocol": "Http",
              "requireServerNameIndication": false
            },
            "type": "Microsoft.Network/applicationGateways/httpListeners"
          }
        ],
        "urlPathMaps": [],
        "requestRoutingRules": [
          {
            "name": "rule1",
            "etag": "W/\"2395ec85-c71e-47df-93fe-e3c46867f7c0\"",
            "properties": {
              "provisioningState": "Succeeded",
              "ruleType": "Basic",
              "httpListener": {
                "id": "[concat(resourceId('Microsoft.Network/applicationGateways', parameters('applicationGateways_globant_gateway_name')), '/httpListeners/appGatewayHttpListener')]"
              },
              "backendAddressPool": {
                "id": "[concat(resourceId('Microsoft.Network/applicationGateways', parameters('applicationGateways_globant_gateway_name')), '/backendAddressPools/appGatewayBackendPool')]"
              },
              "backendHttpSettings": {
                "id": "[concat(resourceId('Microsoft.Network/applicationGateways', parameters('applicationGateways_globant_gateway_name')), '/backendHttpSettingsCollection/appGatewayBackendHttpSettings')]"
              }
            },
            "type": "Microsoft.Network/applicationGateways/requestRoutingRules"
          }
        ],
        "probes": [
          {
            "name": "appGatewayBackendHttpSettings67ee2a16-db6a-46ad-bc17-600861325012",
            "etag": "W/\"2395ec85-c71e-47df-93fe-e3c46867f7c0\"",
            "properties": {
              "provisioningState": "Succeeded",
              "protocol": "Http",
              "path": "/",
              "interval": 30,
              "timeout": 30,
              "unhealthyThreshold": 3,
              "pickHostNameFromBackendHttpSettings": true,
              "minServers": 0,
              "match": {}
            },
            "type": "Microsoft.Network/applicationGateways/probes"
          }
        ],
        "rewriteRuleSets": [],
        "redirectConfigurations": [],
        "webApplicationFirewallConfiguration": {
          "enabled": true,
          "firewallMode": "Detection",
          "ruleSetType": "OWASP",
          "ruleSetVersion": "3.0",
          "disabledRuleGroups": [],
          "requestBodyCheck": true,
          "maxRequestBodySizeInKb": 128,
          "fileUploadLimitInMb": 100
        },
        "enableHttp2": false
      }
    },
    {
      "type": "Microsoft.Network/publicIPAddresses",
      "apiVersion": "2018-12-01",
      "name": "[parameters('publicIPAddresses_globant_gateway_ip_name')]",
      "location": "westus",
      "sku": {
        "name": "Basic",
        "tier": "Regional"
      },
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "f6e7347c-ace8-4ab6-b24b-45a0f79ef78b",
        "ipAddress": "104.42.127.109",
        "publicIPAddressVersion": "IPv4",
        "publicIPAllocationMethod": "Dynamic",
        "idleTimeoutInMinutes": 4,
        "dnsSettings": {
          "fqdn": "67b22b99-062e-45a0-96d6-a63b18e7e154.cloudapp.net",
          "domainNameLabel": "[parameters('publicIPAddresses_globant_gateway_ip_domainNameLabel')]"
        },
        "ipTags": []
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups",
      "apiVersion": "2018-12-01",
      "name": "[parameters('networkSecurityGroups_ad_nsg_name')]",
      "location": "westus",
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "dba95aeb-d039-4700-9d72-1da75ea280b9",
        "securityRules": [
          {
            "name": "allowed_by_jump_server",
            "etag": "W/\"e0deff71-065a-4e33-ae47-1bd8c31a5559\"",
            "properties": {
              "provisioningState": "Succeeded",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "192.168.1.0/24",
              "destinationAddressPrefix": "*",
              "access": "Allow",
              "priority": 100,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          }
        ],
        "defaultSecurityRules": [
          {
            "name": "AllowVnetInBound",
            "etag": "W/\"e0deff71-065a-4e33-ae47-1bd8c31a5559\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow inbound traffic from all VMs in VNET",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefix": "VirtualNetwork",
              "access": "Allow",
              "priority": 65000,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "AllowAzureLoadBalancerInBound",
            "etag": "W/\"e0deff71-065a-4e33-ae47-1bd8c31a5559\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow inbound traffic from azure load balancer",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "AzureLoadBalancer",
              "destinationAddressPrefix": "*",
              "access": "Allow",
              "priority": 65001,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "DenyAllInBound",
            "etag": "W/\"e0deff71-065a-4e33-ae47-1bd8c31a5559\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Deny all inbound traffic",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "*",
              "access": "Deny",
              "priority": 65500,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "AllowVnetOutBound",
            "etag": "W/\"e0deff71-065a-4e33-ae47-1bd8c31a5559\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow outbound traffic from all VMs to all VMs in VNET",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefix": "VirtualNetwork",
              "access": "Allow",
              "priority": 65000,
              "direction": "Outbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "AllowInternetOutBound",
            "etag": "W/\"e0deff71-065a-4e33-ae47-1bd8c31a5559\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow outbound traffic from all VMs to Internet",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "Internet",
              "access": "Allow",
              "priority": 65001,
              "direction": "Outbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "DenyAllOutBound",
            "etag": "W/\"e0deff71-065a-4e33-ae47-1bd8c31a5559\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Deny all outbound traffic",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "*",
              "access": "Deny",
              "priority": 65500,
              "direction": "Outbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          }
        ]
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups",
      "apiVersion": "2018-12-01",
      "name": "[parameters('networkSecurityGroups_jump_nsg_name')]",
      "location": "westus",
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "00b755ab-5d52-47e6-acca-d20f190646fc",
        "securityRules": [
          {
            "name": "RDP",
            "etag": "W/\"098fff35-2c6f-4f32-90c3-dd2fca6ac116\"",
            "properties": {
              "provisioningState": "Succeeded",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "3389",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "*",
              "access": "Allow",
              "priority": 100,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          }
        ],
        "defaultSecurityRules": [
          {
            "name": "AllowVnetInBound",
            "etag": "W/\"098fff35-2c6f-4f32-90c3-dd2fca6ac116\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow inbound traffic from all VMs in VNET",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefix": "VirtualNetwork",
              "access": "Allow",
              "priority": 65000,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "AllowAzureLoadBalancerInBound",
            "etag": "W/\"098fff35-2c6f-4f32-90c3-dd2fca6ac116\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow inbound traffic from azure load balancer",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "AzureLoadBalancer",
              "destinationAddressPrefix": "*",
              "access": "Allow",
              "priority": 65001,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "DenyAllInBound",
            "etag": "W/\"098fff35-2c6f-4f32-90c3-dd2fca6ac116\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Deny all inbound traffic",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "*",
              "access": "Deny",
              "priority": 65500,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "AllowVnetOutBound",
            "etag": "W/\"098fff35-2c6f-4f32-90c3-dd2fca6ac116\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow outbound traffic from all VMs to all VMs in VNET",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefix": "VirtualNetwork",
              "access": "Allow",
              "priority": 65000,
              "direction": "Outbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "AllowInternetOutBound",
            "etag": "W/\"098fff35-2c6f-4f32-90c3-dd2fca6ac116\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow outbound traffic from all VMs to Internet",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "Internet",
              "access": "Allow",
              "priority": 65001,
              "direction": "Outbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "DenyAllOutBound",
            "etag": "W/\"098fff35-2c6f-4f32-90c3-dd2fca6ac116\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Deny all outbound traffic",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "*",
              "access": "Deny",
              "priority": 65500,
              "direction": "Outbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          }
        ]
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups",
      "apiVersion": "2018-12-01",
      "name": "[parameters('networkSecurityGroups_tool_nsg_name')]",
      "location": "westus",
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "99c2ecf7-0e26-46ba-81bb-99a543f4553e",
        "securityRules": [],
        "defaultSecurityRules": [
          {
            "name": "AllowVnetInBound",
            "etag": "W/\"9b46e79e-39b5-43c0-9391-da08496d62df\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow inbound traffic from all VMs in VNET",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefix": "VirtualNetwork",
              "access": "Allow",
              "priority": 65000,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "AllowAzureLoadBalancerInBound",
            "etag": "W/\"9b46e79e-39b5-43c0-9391-da08496d62df\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow inbound traffic from azure load balancer",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "AzureLoadBalancer",
              "destinationAddressPrefix": "*",
              "access": "Allow",
              "priority": 65001,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "DenyAllInBound",
            "etag": "W/\"9b46e79e-39b5-43c0-9391-da08496d62df\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Deny all inbound traffic",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "*",
              "access": "Deny",
              "priority": 65500,
              "direction": "Inbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "AllowVnetOutBound",
            "etag": "W/\"9b46e79e-39b5-43c0-9391-da08496d62df\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow outbound traffic from all VMs to all VMs in VNET",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "VirtualNetwork",
              "destinationAddressPrefix": "VirtualNetwork",
              "access": "Allow",
              "priority": 65000,
              "direction": "Outbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "AllowInternetOutBound",
            "etag": "W/\"9b46e79e-39b5-43c0-9391-da08496d62df\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Allow outbound traffic from all VMs to Internet",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "Internet",
              "access": "Allow",
              "priority": 65001,
              "direction": "Outbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          },
          {
            "name": "DenyAllOutBound",
            "etag": "W/\"9b46e79e-39b5-43c0-9391-da08496d62df\"",
            "properties": {
              "provisioningState": "Succeeded",
              "description": "Deny all outbound traffic",
              "protocol": "*",
              "sourcePortRange": "*",
              "destinationPortRange": "*",
              "sourceAddressPrefix": "*",
              "destinationAddressPrefix": "*",
              "access": "Deny",
              "priority": 65500,
              "direction": "Outbound",
              "sourcePortRanges": [],
              "destinationPortRanges": [],
              "sourceAddressPrefixes": [],
              "destinationAddressPrefixes": []
            }
          }
        ]
      }
    },
    {
      "type": "Microsoft.Network/publicIPAddresses",
      "apiVersion": "2018-12-01",
      "name": "[parameters('publicIPAddresses_ad_server_ip_name')]",
      "location": "westus",
      "sku": {
        "name": "Basic",
        "tier": "Regional"
      },
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "a383bd8a-123a-4a89-8d63-2fe0cd0ac2dc",
        "ipAddress": "40.78.90.6",
        "publicIPAddressVersion": "IPv4",
        "publicIPAllocationMethod": "Dynamic",
        "idleTimeoutInMinutes": 4,
        "ipTags": []
      }
    },
    {
      "type": "Microsoft.Network/publicIPAddresses",
      "apiVersion": "2018-12-01",
      "name": "[parameters('publicIPAddresses_jum_server_ip_name')]",
      "location": "westus",
      "sku": {
        "name": "Basic",
        "tier": "Regional"
      },
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "c73a2a31-dc2b-4f8d-9036-58e31cab0841",
        "ipAddress": "40.78.83.165",
        "publicIPAddressVersion": "IPv4",
        "publicIPAllocationMethod": "Dynamic",
        "idleTimeoutInMinutes": 4,
        "ipTags": []
      }
    },
    {
      "type": "Microsoft.Network/publicIPAddresses",
      "apiVersion": "2018-12-01",
      "name": "[parameters('publicIPAddresses_tool_server_ip_name')]",
      "location": "westus",
      "sku": {
        "name": "Basic",
        "tier": "Regional"
      },
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "18fa7911-1518-42d8-a502-83e090c9fd32",
        "ipAddress": "40.78.83.170",
        "publicIPAddressVersion": "IPv4",
        "publicIPAllocationMethod": "Dynamic",
        "idleTimeoutInMinutes": 4,
        "ipTags": []
      }
    },
    {
      "type": "Microsoft.Sql/servers",
      "apiVersion": "2015-05-01-preview",
      "name": "[parameters('servers_globant_database_server_name')]",
      "location": "westus",
      "kind": "v12.0",
      "properties": {
        "administratorLogin": "ankit.singh",
        "administratorLoginPassword": "Meetu@1234567890",
        "version": "12.0"
      }
    },
    {
      "type": "Microsoft.Storage/storageAccounts",
      "apiVersion": "2018-07-01",
      "name": "[parameters('storageAccounts_globantstorage_name')]",
      "location": "westus",
      "sku": {
        "name": "Standard_LRS",
        "tier": "Standard"
      },
      "kind": "Storage",
      "properties": {
        "networkAcls": {
          "bypass": "AzureServices",
          "virtualNetworkRules": [],
          "ipRules": [],
          "defaultAction": "Allow"
        },
        "supportsHttpsTrafficOnly": false,
        "encryption": {
          "services": {
            "file": {
              "enabled": true
            },
            "blob": {
              "enabled": true
            }
          },
          "keySource": "Microsoft.Storage"
        }
      }
    },
    {
      "type": "Microsoft.Web/serverfarms",
      "apiVersion": "2016-09-01",
      "name": "[parameters('serverfarms_globant_plan_name')]",
      "location": "WestUS",
      "sku": {
        "name": "S1",
        "tier": "Standard",
        "size": "S1",
        "family": "S",
        "capacity": 1
      },
      "kind": "app",
      "properties": {
        "name": "[parameters('serverfarms_globant_plan_name')]",
        "perSiteScaling": false,
        "reserved": false,
        "targetWorkerCount": 0,
        "targetWorkerSizeId": 0
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "apiVersion": "2018-12-01",
      "name": "[concat(parameters('networkSecurityGroups_ad_nsg_name'), '/allowed_by_jump_server')]",
      "dependsOn": [
        "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_ad_nsg_name'))]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "protocol": "*",
        "sourcePortRange": "*",
        "destinationPortRange": "*",
        "sourceAddressPrefix": "192.168.1.0/24",
        "destinationAddressPrefix": "*",
        "access": "Allow",
        "priority": 100,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "apiVersion": "2018-12-01",
      "name": "[concat(parameters('networkSecurityGroups_jump_nsg_name'), '/RDP')]",
      "dependsOn": [
        "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_jump_nsg_name'))]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "protocol": "*",
        "sourcePortRange": "*",
        "destinationPortRange": "3389",
        "sourceAddressPrefix": "*",
        "destinationAddressPrefix": "*",
        "access": "Allow",
        "priority": 100,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "apiVersion": "2018-12-01",
      "name": "[concat(parameters('networkSecurityGroups_tool_nsg_name'), '/RDP')]",
      "dependsOn": [
        "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_tool_nsg_name'))]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "protocol": "*",
        "sourcePortRange": "*",
        "destinationPortRange": "3389",
        "sourceAddressPrefix": "*",
        "destinationAddressPrefix": "*",
        "access": "Allow",
        "priority": 100,
        "direction": "Inbound",
        "sourcePortRanges": [],
        "destinationPortRanges": [],
        "sourceAddressPrefixes": [],
        "destinationAddressPrefixes": []
      }
    },
    {
      "type": "Microsoft.Sql/servers/databases",
      "apiVersion": "2017-03-01-preview",
      "name": "[concat(parameters('servers_globant_database_server_name'), '/globant-database')]",
      "location": "westus",
      "dependsOn": [
        "[resourceId('Microsoft.Sql/servers', parameters('servers_globant_database_server_name'))]"
      ],
      "sku": {
        "name": "S0",
        "tier": "Standard"
      },
      "kind": "v12.0,user",
      "properties": {
        "collation": "SQL_Latin1_General_CP1_CI_AS",
        "maxSizeBytes": 5368709120,
        "catalogCollation": "SQL_Latin1_General_CP1_CI_AS",
        "zoneRedundant": false
      }
    },
    {
      "type": "Microsoft.Sql/servers/encryptionProtector",
      "apiVersion": "2015-05-01-preview",
      "name": "[concat(parameters('servers_globant_database_server_name'), '/current')]",
      "dependsOn": [
        "[resourceId('Microsoft.Sql/servers', parameters('servers_globant_database_server_name'))]"
      ],
      "kind": "servicemanaged",
      "properties": {
        "serverKeyName": "ServiceManaged",
        "serverKeyType": "ServiceManaged"
      }
    },
    {
      "type": "Microsoft.Sql/servers/firewallRules",
      "apiVersion": "2015-05-01-preview",
      "name": "[concat(parameters('servers_globant_database_server_name'), '/AllowAllWindowsAzureIps')]",
      "dependsOn": [
        "[resourceId('Microsoft.Sql/servers', parameters('servers_globant_database_server_name'))]"
      ],
      "properties": {
        "startIpAddress": "0.0.0.0",
        "endIpAddress": "0.0.0.0"
      }
    },
    {
      "type": "Microsoft.Sql/servers/securityAlertPolicies",
      "apiVersion": "2017-03-01-preview",
      "name": "[concat(parameters('servers_globant_database_server_name'), '/Default')]",
      "dependsOn": [
        "[resourceId('Microsoft.Sql/servers', parameters('servers_globant_database_server_name'))]"
      ],
      "properties": {
        "state": "Disabled",
        "disabledAlerts": [
          ""
        ],
        "emailAddresses": [
          ""
        ],
        "emailAccountAdmins": false,
        "storageEndpoint": "",
        "storageAccountAccessKey": "",
        "retentionDays": 0
      }
    },
    {
      "type": "Microsoft.Web/sites",
      "apiVersion": "2016-08-01",
      "name": "[parameters('sites_globant_app_name')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_globant_plan_name'))]"
      ],
      "kind": "app",
      "properties": {
        "enabled": true,
        "hostNameSslStates": [
          {
            "name": "[concat(parameters('sites_globant_app_name'), '.azurewebsites.net')]",
            "sslState": "Disabled",
            "hostType": "Standard"
          },
          {
            "name": "[concat(parameters('sites_globant_app_name'), '.scm.azurewebsites.net')]",
            "sslState": "Disabled",
            "hostType": "Repository"
          }
        ],
        "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_globant_plan_name'))]",
        "reserved": false,
        "scmSiteAlsoStopped": false,
        "clientAffinityEnabled": true,
        "clientCertEnabled": false,
        "hostNamesDisabled": false,
        "containerSize": 0,
        "dailyMemoryTimeQuota": 0,
        "httpsOnly": false
      }
    },
    {
      "type": "Microsoft.Web/sites/config",
      "apiVersion": "2016-08-01",
      "name": "[concat(parameters('sites_globant_app_name'), '/web')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Web/sites', parameters('sites_globant_app_name'))]"
      ],
      "properties": {
        "numberOfWorkers": 1,
        "defaultDocuments": [
          "Default.htm",
          "Default.html",
          "Default.asp",
          "index.htm",
          "index.html",
          "iisstart.htm",
          "default.aspx",
          "index.php",
          "hostingstart.html"
        ],
        "netFrameworkVersion": "v4.0",
        "phpVersion": "5.6",
        "pythonVersion": "",
        "nodeVersion": "",
        "linuxFxVersion": "",
        "requestTracingEnabled": false,
        "remoteDebuggingEnabled": false,
        "httpLoggingEnabled": false,
        "logsDirectorySizeLimit": 35,
        "detailedErrorLoggingEnabled": false,
        "publishingUsername": "$globant-app",
        "scmType": "None",
        "use32BitWorkerProcess": true,
        "webSocketsEnabled": false,
        "alwaysOn": false,
        "appCommandLine": "",
        "managedPipelineMode": "Integrated",
        "virtualApplications": [
          {
            "virtualPath": "/",
            "physicalPath": "site\\wwwroot",
            "preloadEnabled": false,
            "virtualDirectories": null
          }
        ],
        "winAuthAdminState": 0,
        "winAuthTenantState": 0,
        "customAppPoolIdentityAdminState": false,
        "customAppPoolIdentityTenantState": false,
        "loadBalancing": "LeastRequests",
        "routingRules": [],
        "experiments": {
          "rampUpRules": []
        },
        "autoHealEnabled": false,
        "vnetName": "",
        "siteAuthEnabled": false,
        "siteAuthSettings": {
          "enabled": null,
          "unauthenticatedClientAction": null,
          "tokenStoreEnabled": null,
          "allowedExternalRedirectUrls": null,
          "defaultProvider": null,
          "clientId": null,
          "clientSecret": null,
          "clientSecretCertificateThumbprint": null,
          "issuer": null,
          "allowedAudiences": null,
          "additionalLoginParams": null,
          "isAadAutoProvisioned": false,
          "googleClientId": null,
          "googleClientSecret": null,
          "googleOAuthScopes": null,
          "facebookAppId": null,
          "facebookAppSecret": null,
          "facebookOAuthScopes": null,
          "twitterConsumerKey": null,
          "twitterConsumerSecret": null,
          "microsoftAccountClientId": null,
          "microsoftAccountClientSecret": null,
          "microsoftAccountOAuthScopes": null
        },
        "localMySqlEnabled": false,
        "http20Enabled": false,
        "minTlsVersion": "1.2",
        "ftpsState": "AllAllowed",
        "reservedInstanceCount": 0
      }
    },
    {
      "type": "Microsoft.Web/sites/hostNameBindings",
      "apiVersion": "2016-08-01",
      "name": "[concat(parameters('sites_globant_app_name'), '/', parameters('sites_globant_app_name'), '.azurewebsites.net')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Web/sites', parameters('sites_globant_app_name'))]"
      ],
      "properties": {
        "siteName": "globant-app",
        "hostNameType": "Verified"
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines",
      "apiVersion": "2018-10-01",
      "name": "[parameters('virtualMachines_ad_server_name')]",
      "location": "westus",
      "dependsOn": [
        "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_ad_server_network_interface_name'))]",
        "[resourceId('Microsoft.Storage/StorageAccounts', parameters('storageAccounts_globantstorage_name'))]"
      ],
      "properties": {
        "hardwareProfile": {
          "vmSize": "Standard_DS1_v2"
        },
        "storageProfile": {
          "imageReference": {
            "publisher": "MicrosoftWindowsServer",
            "offer": "WindowsServer",
            "sku": "2016-Datacenter",
            "version": "latest"
          },
          "osDisk": {
            "osType": "Windows",
            "name": "[concat(parameters('virtualMachines_ad_server_name'), '_OsDisk_1_99c93714fa28470fad31df7f66d158fa')]",
            "createOption": "FromImage",
            "caching": "ReadWrite",
            "managedDisk": {
              "storageAccountType": "Premium_LRS"
            },
            "diskSizeGB": 127
          },
          "dataDisks": [
            {
              "lun": 0,
              "name": "datadisk",
              "createOption": "Empty",
              "caching": "None",
              "managedDisk": {
                "storageAccountType": "Standard_LRS"
              },
              "diskSizeGB": 100
            }
          ]
        },
        "osProfile": {
          "computerName": "[parameters('virtualMachines_ad_server_name')]",
          "adminUsername": "ankit.singh",
          "adminpassword": "Meetu@1234567890",
          "windowsConfiguration": {
            "provisionVMAgent": true,
            "enableAutomaticUpdates": true
          },
          "secrets": [],
          "allowExtensionOperations": true
        },
        "networkProfile": {
          "networkInterfaces": [
            {
              "id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_ad_server_network_interface_name'))]"
            }
          ]
        },
        "diagnosticsProfile": {
          "bootDiagnostics": {
            "enabled": true,
            "storageUri": "[concat('https://', parameters('storageAccounts_globantstorage_name'), '.blob.core.windows.net/')]"
          }
        }
      },
      "resources": [
        {
          "name": "Microsoft.Powershell.DSC",
          "type": "extensions",
          "location": "westus",
          "apiVersion": "2016-03-30",
          "dependsOn": [
            "[resourceId('Microsoft.Compute/virtualMachines', parameters('virtualMachines_ad_server_name'))]"
          ],
          "tags": {
            "displayName": "dscDC"
          },
          "properties": {
            "publisher": "Microsoft.Powershell",
            "type": "DSC",
            "typeHandlerVersion": "2.9",
            "autoUpgradeMinorVersion": true,
            "settings": {
              "configuration": {
                "url": "[concat(parameters('_artifactsLocation'), '/', variables('dscDCArchiveFolder'), '/', variables('dscDCArchiveFileName'))]",
                "script": "dscDC.ps1",
                "function": "Main"
              },
              "configurationArguments": {
                "nodeName": "[parameters('virtualMachines_ad_server_name')]",
                "FQDomainName": "[parameters('FQDomainName')]"
              },
              "configurationData": {
                "url": "https://raw.githubusercontent.com/GhassanHariz/AzureRMDSC/master/DCVM-DSC.psd1"
              }
            },
            "protectedSettings": {
              "configurationArguments": {
                "DomainAdmin1Creds": {
                  "userName": "ankit.singh",
                  "password": "Meetu@1234567890"
                },
                "AdminUser1Creds": {
                  "userName": "AdminUser1",
                  "password": "Meetu@1234567890"
                }
              },
              "configurationUrlSasToken": "[parameters('_artifactsLocationSasToken')]"
            }
          }
        }
      ]
    },
    {
      "type": "Microsoft.Compute/virtualMachines",
      "apiVersion": "2018-10-01",
      "name": "[parameters('virtualMachines_jum_server_name')]",
      "location": "westus",
      "dependsOn": [
        "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_jum_server_network_interface_name'))]",
        "[resourceId('Microsoft.Storage/StorageAccounts', parameters('storageAccounts_globantstorage_name'))]"
      ],
      "properties": {
        "hardwareProfile": {
          "vmSize": "Standard_DS1_v2"
        },
        "storageProfile": {
          "imageReference": {
            "publisher": "MicrosoftWindowsServer",
            "offer": "WindowsServer",
            "sku": "2016-Datacenter",
            "version": "latest"
          },
          "osDisk": {
            "osType": "Windows",
            "name": "[concat(parameters('virtualMachines_jum_server_name'), '_OsDisk_1_ede97a8f2577428eabfc440814ae393a')]",
            "createOption": "FromImage",
            "caching": "ReadWrite",
            "managedDisk": {
              "storageAccountType": "Premium_LRS"
            },
            "diskSizeGB": 128
          },
          "dataDisks": []
        },
        "osProfile": {
          "computerName": "[parameters('virtualMachines_jum_server_name')]",
          "adminUsername": "ankit.singh",
          "adminpassword": "Meetu@1234567890",
          "windowsConfiguration": {
            "provisionVMAgent": true,
            "enableAutomaticUpdates": true
          },
          "secrets": [],
          "allowExtensionOperations": true
        },
        "networkProfile": {
          "networkInterfaces": [
            {
              "id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_jum_server_network_interface_name'))]"
            }
          ]
        },
        "diagnosticsProfile": {
          "bootDiagnostics": {
            "enabled": true,
            "storageUri": "[concat('https://', parameters('storageAccounts_globantstorage_name'), '.blob.core.windows.net/')]"
          }
        }
      }
    },
    {
      "type": "Microsoft.Compute/virtualMachines",
      "apiVersion": "2018-10-01",
      "name": "[parameters('virtualMachines_tool_server_name')]",
      "location": "westus",
      "dependsOn": [
        "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_tool_server_network_interface_name'))]",
        "[resourceId('Microsoft.Storage/StorageAccounts', parameters('storageAccounts_globantstorage_name'))]"
      ],
      "properties": {
        "hardwareProfile": {
          "vmSize": "Standard_DS1_v2"
        },
        "storageProfile": {
          "imageReference": {
            "publisher": "MicrosoftWindowsServer",
            "offer": "WindowsServer",
            "sku": "2016-Datacenter",
            "version": "latest"
          },
          "osDisk": {
            "osType": "Windows",
            "name": "[concat(parameters('virtualMachines_tool_server_name'), '_OsDisk_1_e0a7a5528a9d4448a6dc7ed807e6cfa3')]",
            "createOption": "FromImage",
            "caching": "ReadWrite",
            "managedDisk": {
              "storageAccountType": "Premium_LRS"
            },
            "diskSizeGB": 127
          },
          "dataDisks": []
        },
        "osProfile": {
          "computerName": "[parameters('virtualMachines_tool_server_name')]",
          "adminUsername": "ankit.singh",
          "adminPassword": "Meetu@1234567890",
          "windowsConfiguration": {
            "provisionVMAgent": true,
            "enableAutomaticUpdates": true
          },
          "secrets": [],
          "allowExtensionOperations": true
        },
        "networkProfile": {
          "networkInterfaces": [
            {
              "id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_tool_server_network_interface_name'))]"
            }
          ]
        },
        "diagnosticsProfile": {
          "bootDiagnostics": {
            "enabled": true,
            "storageUri": "[concat('https://', parameters('storageAccounts_globantstorage_name'), '.blob.core.windows.net/')]"
          }
        }
      }
    },
    {
      "type": "Microsoft.Network/networkInterfaces",
      "apiVersion": "2018-12-01",
      "name": "[parameters('networkInterfaces_ad_server_network_interface_name')]",
      "location": "westus",
      "dependsOn": [
        "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_ad_server_ip_name'))]",
        "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_globant_vnet_name'), 'ad-subnet')]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "f4bc1fcd-bd6b-438b-b01c-0f20df884071",
        "ipConfigurations": [
          {
            "name": "ipconfig1",
            "etag": "W/\"870b6f23-d433-459d-ae5a-3a681d453740\"",
            "properties": {
              "provisioningState": "Succeeded",
              "privateIPAddress": "192.168.2.4",
              "privateIPAllocationMethod": "Dynamic",
              "publicIPAddress": {
                "id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_ad_server_ip_name'))]"
              },
              "subnet": {
                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_globant_vnet_name'), 'ad-subnet')]"
              },
              "primary": true,
              "privateIPAddressVersion": "IPv4"
            }
          }
        ],
        "dnsSettings": {
          "dnsServers": [],
          "appliedDnsServers": [],
          "internalDomainNameSuffix": "xjcnp4kdabxe3jxu3pxzvceegf.dx.internal.cloudapp.net"
        },
        "macAddress": "00-0D-3A-32-1B-68",
        "enableAcceleratedNetworking": false,
        "enableIPForwarding": false,
        "primary": true,
        "tapConfigurations": []
      }
    },
    {
      "type": "Microsoft.Network/networkInterfaces",
      "apiVersion": "2018-12-01",
      "name": "[parameters('networkInterfaces_jum_server_network_interface_name')]",
      "location": "westus",
      "dependsOn": [
        "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_jum_server_ip_name'))]",
        "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_globant_vnet_name'), 'jump-subnet')]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "e341bbeb-e373-49e8-9beb-d6173c51e78f",
        "ipConfigurations": [
          {
            "name": "ipconfig1",
            "etag": "W/\"8e51d378-5969-4e25-9541-5c6c6224702d\"",
            "properties": {
              "provisioningState": "Succeeded",
              "privateIPAddress": "192.168.1.4",
              "privateIPAllocationMethod": "Dynamic",
              "publicIPAddress": {
                "id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_jum_server_ip_name'))]"
              },
              "subnet": {
                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_globant_vnet_name'), 'jump-subnet')]"
              },
              "primary": true,
              "privateIPAddressVersion": "IPv4"
            }
          }
        ],
        "dnsSettings": {
          "dnsServers": [],
          "appliedDnsServers": [],
          "internalDomainNameSuffix": "xjcnp4kdabxe3jxu3pxzvceegf.dx.internal.cloudapp.net"
        },
        "macAddress": "00-0D-3A-32-10-A5",
        "enableAcceleratedNetworking": false,
        "enableIPForwarding": false,
        "primary": true,
        "tapConfigurations": []
      }
    },
    {
      "type": "Microsoft.Network/networkInterfaces",
      "apiVersion": "2018-12-01",
      "name": "[parameters('networkInterfaces_tool_server_network_interface_name')]",
      "location": "westus",
      "dependsOn": [
        "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_tool_server_ip_name'))]",
        "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_globant_vnet_name'), 'tool-subnet')]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "2da1a0fa-30ba-43be-bbaa-4bb4fbe9c9c4",
        "ipConfigurations": [
          {
            "name": "ipconfig1",
            "etag": "W/\"5491cac6-f002-45da-87d6-04eb1836d5e6\"",
            "properties": {
              "provisioningState": "Succeeded",
              "privateIPAddress": "192.168.3.4",
              "privateIPAllocationMethod": "Dynamic",
              "publicIPAddress": {
                "id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_tool_server_ip_name'))]"
              },
              "subnet": {
                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_globant_vnet_name'), 'tool-subnet')]"
              },
              "primary": true,
              "privateIPAddressVersion": "IPv4"
            }
          }
        ],
        "dnsSettings": {
          "dnsServers": [],
          "appliedDnsServers": [],
          "internalDomainNameSuffix": "xjcnp4kdabxe3jxu3pxzvceegf.dx.internal.cloudapp.net"
        },
        "macAddress": "00-0D-3A-32-1B-42",
        "enableAcceleratedNetworking": false,
        "enableIPForwarding": false,
        "primary": true,
        "tapConfigurations": []
      }
    },
    {
      "type": "Microsoft.Network/virtualNetworks/subnets",
      "apiVersion": "2018-12-01",
      "name": "[concat(parameters('virtualNetworks_globant_vnet_name'), '/ad-subnet')]",
      "dependsOn": [
        "[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_globant_vnet_name'))]",
        "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_ad_nsg_name'))]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "addressPrefix": "192.168.2.0/24",
        "networkSecurityGroup": {
          "id": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_ad_nsg_name'))]"
        },
        "serviceEndpoints": [],
        "delegations": []
      }
    },
    {
      "type": "Microsoft.Network/virtualNetworks/subnets",
      "apiVersion": "2018-12-01",
      "name": "[concat(parameters('virtualNetworks_globant_vnet_name'), '/jump-subnet')]",
      "dependsOn": [
        "[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_globant_vnet_name'))]",
        "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_jump_nsg_name'))]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "addressPrefix": "192.168.1.0/24",
        "networkSecurityGroup": {
          "id": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_jump_nsg_name'))]"
        },
        "serviceEndpoints": [],
        "delegations": []
      }
    },
    {
      "type": "Microsoft.Network/virtualNetworks/subnets",
      "apiVersion": "2018-12-01",
      "name": "[concat(parameters('virtualNetworks_globant_vnet_name'), '/tool-subnet')]",
      "dependsOn": [
        "[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_globant_vnet_name'))]",
        "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_tool_nsg_name'))]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "addressPrefix": "192.168.3.0/24",
        "networkSecurityGroup": {
          "id": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_tool_nsg_name'))]"
        },
        "serviceEndpoints": [],
        "delegations": []
      }
    },
    {
      "type": "Microsoft.Network/virtualNetworks/subnets",
      "apiVersion": "2018-12-01",
      "name": "[concat(parameters('virtualNetworks_globant_vnet_name'), '/default-subnet')]",
      "dependsOn": [
        "[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_globant_vnet_name'))]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "addressPrefix": "192.168.4.0/24",
        "serviceEndpoints": [],
        "delegations": []
      }
    },
    {
      "type": "Microsoft.Sql/servers/databases/auditingPolicies",
      "apiVersion": "2014-04-01",
      "name": "[concat(parameters('servers_globant_database_server_name'), '/globant-database/Default')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Sql/servers/databases', parameters('servers_globant_database_server_name'), 'globant-database')]",
        "[resourceId('Microsoft.Sql/servers', parameters('servers_globant_database_server_name'))]"
      ],
      "properties": {
        "auditingState": "disabled",
        "eventTypesToAudit": "PlainSQL_Success,PlainSQL_Failure,ParameterizedSQL_Success,ParameterizedSQL_Failure,StoredProcedure_Success,StoredProcedure_Failure,Login_Success,Login_Failure,TransactionManagement_Success,TransactionManagement_Failure",
        "useServerDefault": "Enabled",
        "fullAuditLogsTableName": "SQLDBAuditLogsGlobantdatabaseserverGlobantdatabase",
        "auditLogsTableName": "GlobantdatabaseserverGlobantdatabase",
        "retentionDays": "0"
      }
    },
    {
      "type": "Microsoft.Sql/servers/databases/securityAlertPolicies",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('servers_globant_database_server_name'), '/globant-database/Default')]",
      "dependsOn": [
        "[resourceId('Microsoft.Sql/servers/databases', parameters('servers_globant_database_server_name'), 'globant-database')]",
        "[resourceId('Microsoft.Sql/servers', parameters('servers_globant_database_server_name'))]"
      ],
      "properties": {
        "state": "Disabled",
        "disabledAlerts": [
          ""
        ],
        "emailAddresses": [
          ""
        ],
        "emailAccountAdmins": false,
        "storageEndpoint": "",
        "storageAccountAccessKey": "",
        "retentionDays": 0
      }
    },
    {
      "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
      "apiVersion": "2014-04-01",
      "name": "[concat(parameters('servers_globant_database_server_name'), '/globant-database/current')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Sql/servers/databases', parameters('servers_globant_database_server_name'), 'globant-database')]",
        "[resourceId('Microsoft.Sql/servers', parameters('servers_globant_database_server_name'))]"
      ],
      "properties": {
        "status": "Enabled"
      }
    },
    {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments",
      "apiVersion": "2017-03-01-preview",
      "name": "[concat(parameters('servers_globant_database_server_name'), '/globant-database/Default')]",
      "dependsOn": [
        "[resourceId('Microsoft.Sql/servers/databases', parameters('servers_globant_database_server_name'), 'globant-database')]",
        "[resourceId('Microsoft.Sql/servers', parameters('servers_globant_database_server_name'))]"
      ],
      "properties": {
        "recurringScans": {
          "isEnabled": false,
          "emailSubscriptionAdmins": true
        }
      }
    },
    {
      "type": "Microsoft.Web/sites/slots",
      "apiVersion": "2016-08-01",
      "name": "[concat(parameters('sites_globant_app_name'), '/development-slot')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Web/sites', parameters('sites_globant_app_name'))]",
        "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_globant_plan_name'))]"
      ],
      "kind": "app",
      "properties": {
        "enabled": true,
        "hostNameSslStates": [
          {
            "name": "globant-webapp-development-slot.azurewebsites.net",
            "sslState": "Disabled",
            "hostType": "Standard"
          },
          {
            "name": "globant-webapp-development-slot.scm.azurewebsites.net",
            "sslState": "Disabled",
            "hostType": "Repository"
          }
        ],
        "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_globant_plan_name'))]",
        "reserved": false,
        "scmSiteAlsoStopped": false,
        "clientAffinityEnabled": true,
        "clientCertEnabled": false,
        "hostNamesDisabled": false,
        "containerSize": 0,
        "dailyMemoryTimeQuota": 0,
        "httpsOnly": false
      }
    },
    {
      "type": "Microsoft.Web/sites/slots",
      "apiVersion": "2016-08-01",
      "name": "[concat(parameters('sites_globant_app_name'), '/testing-slot')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Web/sites', parameters('sites_globant_app_name'))]",
        "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_globant_plan_name'))]"
      ],
      "kind": "app",
      "properties": {
        "enabled": true,
        "hostNameSslStates": [
          {
            "name": "globant-webapp-testing-slot.azurewebsites.net",
            "sslState": "Disabled",
            "hostType": "Standard"
          },
          {
            "name": "globant-webapp-testing-slot.scm.azurewebsites.net",
            "sslState": "Disabled",
            "hostType": "Repository"
          }
        ],
        "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_globant_plan_name'))]",
        "reserved": false,
        "scmSiteAlsoStopped": false,
        "clientAffinityEnabled": true,
        "clientCertEnabled": false,
        "hostNamesDisabled": false,
        "containerSize": 0,
        "dailyMemoryTimeQuota": 0,
        "httpsOnly": false
      }
    },
    {
      "type": "Microsoft.Web/sites/slots/config",
      "apiVersion": "2016-08-01",
      "name": "[concat(parameters('sites_globant_app_name'), '/development-slot/web')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Web/sites/slots', parameters('sites_globant_app_name'), 'development-slot')]",
        "[resourceId('Microsoft.Web/sites', parameters('sites_globant_app_name'))]"
      ],
      "properties": {
        "numberOfWorkers": 1,
        "defaultDocuments": [
          "Default.htm",
          "Default.html",
          "Default.asp",
          "index.htm",
          "index.html",
          "iisstart.htm",
          "default.aspx",
          "index.php",
          "hostingstart.html"
        ],
        "netFrameworkVersion": "v4.0",
        "phpVersion": "5.6",
        "pythonVersion": "",
        "nodeVersion": "",
        "linuxFxVersion": "",
        "requestTracingEnabled": false,
        "remoteDebuggingEnabled": false,
        "httpLoggingEnabled": false,
        "logsDirectorySizeLimit": 35,
        "detailedErrorLoggingEnabled": false,
        "publishingUsername": "$globant-webapp__development-slot",
        "scmType": "None",
        "use32BitWorkerProcess": true,
        "webSocketsEnabled": false,
        "alwaysOn": false,
        "appCommandLine": "",
        "managedPipelineMode": "Integrated",
        "virtualApplications": [
          {
            "virtualPath": "/",
            "physicalPath": "site\\wwwroot",
            "preloadEnabled": false,
            "virtualDirectories": null
          }
        ],
        "winAuthAdminState": 0,
        "winAuthTenantState": 0,
        "customAppPoolIdentityAdminState": false,
        "customAppPoolIdentityTenantState": false,
        "loadBalancing": "LeastRequests",
        "routingRules": [],
        "experiments": {
          "rampUpRules": []
        },
        "autoHealEnabled": false,
        "vnetName": "",
        "siteAuthEnabled": false,
        "siteAuthSettings": {
          "enabled": null,
          "unauthenticatedClientAction": null,
          "tokenStoreEnabled": null,
          "allowedExternalRedirectUrls": null,
          "defaultProvider": null,
          "clientId": null,
          "clientSecret": null,
          "clientSecretCertificateThumbprint": null,
          "issuer": null,
          "allowedAudiences": null,
          "additionalLoginParams": null,
          "isAadAutoProvisioned": false,
          "googleClientId": null,
          "googleClientSecret": null,
          "googleOAuthScopes": null,
          "facebookAppId": null,
          "facebookAppSecret": null,
          "facebookOAuthScopes": null,
          "twitterConsumerKey": null,
          "twitterConsumerSecret": null,
          "microsoftAccountClientId": null,
          "microsoftAccountClientSecret": null,
          "microsoftAccountOAuthScopes": null
        },
        "localMySqlEnabled": false,
        "http20Enabled": false,
        "minTlsVersion": "1.2",
        "ftpsState": "AllAllowed",
        "reservedInstanceCount": 0
      }
    },
    {
      "type": "Microsoft.Web/sites/slots/config",
      "apiVersion": "2016-08-01",
      "name": "[concat(parameters('sites_globant_app_name'), '/testing-slot/web')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Web/sites/slots', parameters('sites_globant_app_name'), 'testing-slot')]",
        "[resourceId('Microsoft.Web/sites', parameters('sites_globant_app_name'))]"
      ],
      "properties": {
        "numberOfWorkers": 1,
        "defaultDocuments": [
          "Default.htm",
          "Default.html",
          "Default.asp",
          "index.htm",
          "index.html",
          "iisstart.htm",
          "default.aspx",
          "index.php",
          "hostingstart.html"
        ],
        "netFrameworkVersion": "v4.0",
        "phpVersion": "5.6",
        "pythonVersion": "",
        "nodeVersion": "",
        "linuxFxVersion": "",
        "requestTracingEnabled": false,
        "remoteDebuggingEnabled": false,
        "httpLoggingEnabled": false,
        "logsDirectorySizeLimit": 35,
        "detailedErrorLoggingEnabled": false,
        "publishingUsername": "$globant-webapp__testing-slot",
        "scmType": "None",
        "use32BitWorkerProcess": true,
        "webSocketsEnabled": false,
        "alwaysOn": false,
        "appCommandLine": "",
        "managedPipelineMode": "Integrated",
        "virtualApplications": [
          {
            "virtualPath": "/",
            "physicalPath": "site\\wwwroot",
            "preloadEnabled": false,
            "virtualDirectories": null
          }
        ],
        "winAuthAdminState": 0,
        "winAuthTenantState": 0,
        "customAppPoolIdentityAdminState": false,
        "customAppPoolIdentityTenantState": false,
        "loadBalancing": "LeastRequests",
        "routingRules": [],
        "experiments": {
          "rampUpRules": []
        },
        "autoHealEnabled": false,
        "vnetName": "",
        "siteAuthEnabled": false,
        "siteAuthSettings": {
          "enabled": null,
          "unauthenticatedClientAction": null,
          "tokenStoreEnabled": null,
          "allowedExternalRedirectUrls": null,
          "defaultProvider": null,
          "clientId": null,
          "clientSecret": null,
          "clientSecretCertificateThumbprint": null,
          "issuer": null,
          "allowedAudiences": null,
          "additionalLoginParams": null,
          "isAadAutoProvisioned": false,
          "googleClientId": null,
          "googleClientSecret": null,
          "googleOAuthScopes": null,
          "facebookAppId": null,
          "facebookAppSecret": null,
          "facebookOAuthScopes": null,
          "twitterConsumerKey": null,
          "twitterConsumerSecret": null,
          "microsoftAccountClientId": null,
          "microsoftAccountClientSecret": null,
          "microsoftAccountOAuthScopes": null
        },
        "localMySqlEnabled": false,
        "http20Enabled": false,
        "minTlsVersion": "1.2",
        "ftpsState": "AllAllowed",
        "reservedInstanceCount": 0
      }
    },
    {
      "type": "Microsoft.Web/sites/slots/hostNameBindings",
      "apiVersion": "2016-08-01",
      "name": "[concat(parameters('sites_globant_app_name'), '/development-slot/', parameters('sites_globant_app_name'), '-development-slot.azurewebsites.net')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Web/sites/slots', parameters('sites_globant_app_name'), 'development-slot')]",
        "[resourceId('Microsoft.Web/sites', parameters('sites_globant_app_name'))]"
      ],
      "properties": {
        "siteName": "globant-webapp(development-slot)",
        "hostNameType": "Verified"
      }
    },
    {
      "type": "Microsoft.Web/sites/slots/hostNameBindings",
      "apiVersion": "2016-08-01",
      "name": "[concat(parameters('sites_globant_app_name'), '/testing-slot/', parameters('sites_globant_app_name'), '-testing-slot.azurewebsites.net')]",
      "location": "West US",
      "dependsOn": [
        "[resourceId('Microsoft.Web/sites/slots', parameters('sites_globant_app_name'), 'testing-slot')]",
        "[resourceId('Microsoft.Web/sites', parameters('sites_globant_app_name'))]"
      ],
      "properties": {
        "siteName": "globant-webapp(testing-slot)",
        "hostNameType": "Verified"
      }
    },
    {
      "type": "Microsoft.Network/virtualNetworks",
      "apiVersion": "2018-12-01",
      "name": "[parameters('virtualNetworks_globant_vnet_name')]",
      "location": "westus",
      "dependsOn": [
        "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_jump_nsg_name'))]",
        "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_tool_nsg_name'))]",
        "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_ad_nsg_name'))]"
      ],
      "properties": {
        "provisioningState": "Succeeded",
        "resourceGuid": "f9d744ba-0043-4e6e-a6f4-ebef9a888435",
        "addressSpace": {
          "addressPrefixes": [
            "192.168.0.0/16"
          ]
        },
        "subnets": [
          {
            "name": "jump-subnet",
            "etag": "W/\"60315fc4-61d6-47a5-91ab-f1a5fcde0140\"",
            "properties": {
              "provisioningState": "Succeeded",
              "addressPrefix": "192.168.1.0/24",
              "networkSecurityGroup": {
                "id": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_jump_nsg_name'))]"
              },
              "serviceEndpoints": [],
              "delegations": []
            }
          },
          {
            "name": "tool-subnet",
            "etag": "W/\"60315fc4-61d6-47a5-91ab-f1a5fcde0140\"",
            "properties": {
              "provisioningState": "Succeeded",
              "addressPrefix": "192.168.3.0/24",
              "networkSecurityGroup": {
                "id": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_tool_nsg_name'))]"
              },
              "serviceEndpoints": [],
              "delegations": []
            }
          },
          {
            "name": "ad-subnet",
            "etag": "W/\"60315fc4-61d6-47a5-91ab-f1a5fcde0140\"",
            "properties": {
              "provisioningState": "Succeeded",
              "addressPrefix": "192.168.2.0/24",
              "networkSecurityGroup": {
                "id": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_ad_nsg_name'))]"
              },
              "serviceEndpoints": [],
              "delegations": []
            }
          },
          {
            "name": "default-subnet",
            "etag": "W/\"f9075e8b-bcd4-48f5-8a4c-ad26d5007bfa\"",
            "properties": {
              "provisioningState": "Succeeded",
              "addressPrefix": "192.168.4.0/24",
              "serviceEndpoints": [],
              "delegations": []
            }
          }
        ],
        "virtualNetworkPeerings": [],
        "enableDdosProtection": false,
        "enableVmProtection": false
      }
    }
  ]
}